{"ast":null,"code":"import _classCallCheck from\"/Users/karina/Desktop/projects/pin-it/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/karina/Desktop/projects/pin-it/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/karina/Desktop/projects/pin-it/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/karina/Desktop/projects/pin-it/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/karina/Desktop/projects/pin-it/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{withRouter,Switch,Route,Redirect}from'react-router-dom';import Welcome from'./components/Welcome';import Search from'./components/Search';import Login from'./components/Login';import Signup from'./components/Signup';import Inbox from'./components/Inbox';import Header from'./components/Header';import DisplaySearch from'./containers/DisplaySearch';import TailorSpecs from'./components/TailorSpecs';import DisplayTailorSpecs from'./containers/DisplayTailorSpecs';import DisplayInbox from'./containers/DisplayInbox';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);function App(){var _getPrototypeOf2;var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(App)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={user:null,user_id:null,token:null,error:null,tailors:[],success:false,page:'Welcome',specs:null,messages:null};_this.abortController=new AbortController();_this.newUser=function(info){var first_name=info.first_name;var last_name=info.last_name;var email=info.email;var password=info.password;fetch('/api/v1/users',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({first_name:first_name,last_name:last_name,email:email,password:password})}).then(function(r){return r.json();}).then(function(data){return console.log(\"data\",data);});};_this.getUser=function(info){var email=info.email;var password=info.password;return fetch(\"/api/v1/login\",{method:\"POST\",headers:{\"Content-type\":\"application/json\",\"Accept\":\"application/json\"},body:JSON.stringify({email:email,password:password})}).then(function(r){return r.json();}).then(function(res){console.log(\"res?: \",res);var token=res.token;var user_id=parseInt(res.user_id);localStorage.token=token;localStorage.user_id=user_id;fetch(\"http://localhost:3000/users/\".concat(res.user_id),{headers:{'Content-Type':'application/json','Accept':'application/json','Authorization':token}}).then(function(r){return r.json();}).then(function(user){console.log(user,\"userrrrr\");localStorage.setItem('user',JSON.stringify(user));_this.setState({user:user,user_id:user_id,token:token});});});};_this.logout=function(){console.log(\"logged out\");localStorage.token=null;localStorage.user_id=null;localStorage.user=null;_this.setState({token:null,user_id:'',user:null,error:null});};_this.successLogin=function(){_this.setState({success:true});};_this.revertSuccess=function(){_this.setState({success:false});};_this.getMessages=function(user){fetch('/api/v1/messages').then(function(r){return r.json();}).then(function(messages){console.log(\"messages\",messages);console.log(\"user\",user);console.log(\"user_id\",_this.state.user_id);var user_messages=messages.filter(function(message){return message.receiver_id===_this.state.user_id;});console.log(\"user messages in app\",user_messages);// return user_messages\n_this.setState({messages:user_messages});});};_this.sendMessage=function(message){console.log(\"message?\",message);var sender_id=_this.state.user_id;var receiver_id=message.receiver_id;var title=message.title;var body=message.body;var message_date=message.message_date;fetch('/api/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({sender_id:sender_id,receiver_id:receiver_id,title:title,body:body,message_date:message_date})}).then(function(r){return r.json();}).then(function(res){return console.log(res,\"res\");});};_this.showSpecs=function(tailor){_this.setState({specs:tailor});};_this.resetSpecs=function(){_this.setState({specs:null});};return _this;}_createClass(App,[{key:\"componentDidMount\",// Whenever app is re-rendered, we will be...\nvalue:function componentDidMount(){var _this2=this;var user=JSON.parse(localStorage.getItem('user'));if(localStorage.token){this.setState({token:localStorage.token,user_id:localStorage.user_id,user:user});fetch('http://localhost:3000/users').then(function(r){return r.json();}).then(function(data){var tailors=data.filter(function(d){return d.tailor===true;});_this2.setState({tailors:tailors});});this.getMessages(this.state.user);}}// When we want to register a new user\n},{key:\"render\",value:function render(){var _this3=this;console.log(\"user in state?\",this.state.user);return React.createElement(React.Fragment,null,React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",render:function render(props){return React.createElement(Welcome,{logout:_this3.logout,user:_this3.state.user});}}),React.createElement(Route,{path:\"/search\",render:function render(xprops){return React.createElement(DisplaySearch,{xprops:xprops,user:_this3.state.user,tailors:_this3.state.tailors,success:_this3.state.success,revert:_this3.revertSuccess,resetSpecs:_this3.resetSpecs,specs:_this3.state.specs,showSpecs:_this3.showSpecs});}}),React.createElement(Route,{path:\"/login\",render:function render(props){return React.createElement(Login,{getUser:_this3.getUser,success:_this3.successLogin});}}),React.createElement(Route,{path:\"/signup\",render:function render(xprops){return React.createElement(Signup,{xprops:xprops,newUser:_this3.newUser});}}),React.createElement(Route,{path:\"/inbox\",render:function render(xprops){return React.createElement(DisplayInbox,{xprops:xprops,user:_this3.state.user,messages:_this3.state.messages,sendMessage:_this3.sendMessage});}}),React.createElement(Route,{path:\"/tailor\",render:function render(xprops){return React.createElement(DisplayTailorSpecs,{xprops:xprops,resetSpecs:_this3.resetSpecs,specs:_this3.state.specs,showSpecs:_this3.showSpecs});}})),this.state.success?React.createElement(Redirect,{to:\"/search\"}):null,this.state.specs?React.createElement(Redirect,{to:\"tailor\"}):null);}}]);return App;}(Component);export default withRouter(App);","map":{"version":3,"sources":["/Users/karina/Desktop/projects/pin-it/client/src/App.js"],"names":["React","Component","withRouter","Switch","Route","Redirect","Welcome","Search","Login","Signup","Inbox","Header","DisplaySearch","TailorSpecs","DisplayTailorSpecs","DisplayInbox","App","state","user","user_id","token","error","tailors","success","page","specs","messages","abortController","AbortController","newUser","info","first_name","last_name","email","password","fetch","method","headers","body","JSON","stringify","then","r","json","data","console","log","getUser","res","parseInt","localStorage","setItem","setState","logout","successLogin","revertSuccess","getMessages","user_messages","filter","message","receiver_id","sendMessage","sender_id","title","message_date","showSpecs","tailor","resetSpecs","parse","getItem","d","props","xprops"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withRouter, Switch, Route, Redirect } from 'react-router-dom'\nimport Welcome from './components/Welcome'\nimport Search from './components/Search'\nimport Login from './components/Login'\nimport Signup from './components/Signup'\nimport Inbox from './components/Inbox'\nimport Header from './components/Header'\nimport DisplaySearch from './containers/DisplaySearch'\nimport TailorSpecs from './components/TailorSpecs'\nimport DisplayTailorSpecs from './containers/DisplayTailorSpecs'\nimport DisplayInbox from './containers/DisplayInbox'\n\nclass App extends Component {\n  state = {\n    user: null,\n    user_id: null,\n    token: null,\n    error: null,\n    tailors: [],\n    success: false,\n    page: 'Welcome',\n    specs: null,\n    messages: null\n  }\n\n  abortController = new AbortController()\n\n  // Whenever app is re-rendered, we will be...\n  componentDidMount() {\n    let user = JSON.parse(localStorage.getItem('user'))\n    if (localStorage.token){\n      this.setState({\n        token: localStorage.token,\n        user_id: localStorage.user_id,\n        user\n      })\n      fetch('http://localhost:3000/users')\n      .then(r => r.json())\n      .then(data => {\n        let tailors = data.filter(d => {\n          return d.tailor === true\n        })\n        this.setState({tailors})\n      })\n      this.getMessages(this.state.user)\n    }\n  }\n\n  // When we want to register a new user\n  newUser = info => {\n    let first_name = info.first_name\n    let last_name = info.last_name\n    let email = info.email\n    let password = info.password\n    fetch('/api/v1/users', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ first_name, last_name, email, password })\n    })\n    .then(r => r.json())\n    .then(data => console.log(\"data\", data))\n  }\n\n  // When we have a returning user\n  getUser = info => {\n    let email = info.email\n    let password = info.password\n    return fetch(\"/api/v1/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-type\": \"application/json\",\n        \"Accept\": \"application/json\"\n      },\n      body: JSON.stringify({ email, password })\n    })\n    .then(r => r.json())\n    .then(res => {\n      console.log(\"res?: \", res)\n      let token = res.token\n      let user_id = parseInt(res.user_id)\n      localStorage.token = token\n      localStorage.user_id = user_id\n      fetch(`http://localhost:3000/users/${res.user_id}`, {\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': token\n        }\n      })\n      .then(r => r.json())\n      .then(user => {\n        console.log(user, \"userrrrr\")\n        localStorage.setItem('user', JSON.stringify(user))\n        this.setState({user, user_id, token})\n      })\n    })\n  }\n\n  // When a user logs out\n  logout = () => {\n    console.log(\"logged out\")\n    localStorage.token = null\n    localStorage.user_id = null\n    localStorage.user = null\n    this.setState({\n      token: null,\n      user_id: '',\n      user: null,\n      error: null\n    })\n  }\n\n  successLogin = () => {\n    this.setState({success: true})\n  }\n\n  revertSuccess = () => {\n    this.setState({success: false})\n  }\n\n  getMessages = (user) => {\n    fetch('/api/v1/messages')\n    .then(r => r.json())\n    .then(messages => {\n      console.log(\"messages\", messages)\n      console.log(\"user\", user)\n      console.log(\"user_id\", this.state.user_id)\n      let user_messages = messages.filter(message => {\n        return message.receiver_id === this.state.user_id\n      })\n      console.log(\"user messages in app\", user_messages)\n      // return user_messages\n      this.setState({messages: user_messages})\n    })\n  }\n\n  sendMessage = (message) => {\n    console.log(\"message?\", message)\n    let sender_id = this.state.user_id\n    let receiver_id = message.receiver_id\n    let title = message.title\n    let body = message.body\n    let message_date = message.message_date\n    fetch('/api/v1/messages', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({sender_id, receiver_id, title, body, message_date})\n    })\n    .then(r => r.json())\n    .then(res => console.log(res, \"res\"))\n  }\n\n  showSpecs = (tailor) => {\n    this.setState({\n      specs: tailor\n    })\n  }\n\n  resetSpecs = () => {\n    this.setState({\n      specs: null\n    })\n  }\n\n  render() {\n    console.log(\"user in state?\", this.state.user)\n    return (\n      <>\n      <Switch>\n        <Route exact path='/' render={ (props) => <Welcome logout={ this.logout } user={ this.state.user } /> } />\n        <Route path='/search' render={ (xprops) => <DisplaySearch xprops={xprops} user={ this.state.user } tailors={ this.state.tailors } success={ this.state.success } revert={ this.revertSuccess } resetSpecs={this.resetSpecs} specs={this.state.specs} showSpecs={this.showSpecs} /> } />\n        <Route path='/login' render={ (props) => <Login getUser={ this.getUser } success={this.successLogin} /> } />\n        <Route path='/signup' render={ (xprops) => <Signup xprops={xprops} newUser={ this.newUser } /> } />\n        <Route path='/inbox' render={ (xprops) => <DisplayInbox xprops={xprops} user={ this.state.user } messages={ this.state.messages } sendMessage={ this.sendMessage } /> } />\n        <Route path='/tailor' render={ (xprops) => <DisplayTailorSpecs xprops={xprops} resetSpecs={this.resetSpecs} specs={this.state.specs} showSpecs={this.showSpecs} /> } />\n      </Switch>\n\n      { this.state.success ?\n        <Redirect to='/search' />\n        :\n        null\n      }\n\n      { this.state.specs ?\n        <Redirect to='tailor' />\n        :\n        null\n      }\n\n      </>\n    )\n  }\n}\nexport default withRouter(App)\n"]},"metadata":{},"sourceType":"module"}